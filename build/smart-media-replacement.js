(()=>{"use strict";const e=window.wp.i18n;document.addEventListener("DOMContentLoaded",function(){if(void 0!==window.replaceMediaData&&(n(),"undefined"!=typeof wp&&wp.media)){const e=wp.media.view.Attachment.Details;e&&(wp.media.view.Attachment.Details=e.extend({render(){return e.prototype.render.apply(this,arguments),setTimeout(n,100),this}}))}function t(t,n){if(n&&function(t,n){const o=t.closest("tr");if(!o)return!1;const i=o.nextElementSibling;i&&i.classList.contains("replace-media-inline-error")&&i.remove();const r=document.createElement("tr");r.className="replace-media-inline-error";const a=o.querySelectorAll("td, th").length,c=document.createElement("td");c.colSpan=a,c.style.padding="8px 12px",c.style.backgroundColor="#fcf0f1",c.style.borderLeft="4px solid #d63638";const s=document.createElement("div");s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="space-between";const l=document.createElement("span");l.innerHTML='<strong style="color: #d63638;">'+(0,e.__)("Error:","smart-media-replacement")+"</strong> "+n,s.appendChild(l);const d=document.createElement("button");return d.type="button",d.className="button-link",d.style.color="#d63638",d.style.textDecoration="none",d.style.cursor="pointer",d.textContent=(0,e.__)("Dismiss","smart-media-replacement"),d.addEventListener("click",function(){r.remove()}),s.appendChild(d),c.appendChild(s),r.appendChild(c),o.parentNode.insertBefore(r,o.nextSibling),setTimeout(function(){r.parentNode&&(r.style.transition="opacity 0.3s",r.style.opacity="0",setTimeout(function(){r.remove()},300))},1e4),r.scrollIntoView({behavior:"smooth",block:"nearest"}),!0}(n,t))return;const o="replace-media-error-notice",i=document.getElementById(o);i&&i.remove();const r=document.createElement("div");r.id=o,r.className="notice notice-error is-dismissible",r.style.marginTop="20px",r.style.marginBottom="20px";const a=document.createElement("p");a.innerHTML="<strong>"+(0,e.__)("Media Replacement Error:","smart-media-replacement")+"</strong> "+t,r.appendChild(a);const c=document.createElement("button");c.type="button",c.className="notice-dismiss",c.innerHTML='<span class="screen-reader-text">'+(0,e.__)("Dismiss this notice.","smart-media-replacement")+"</span>",c.addEventListener("click",function(){r.remove()}),r.appendChild(c);const s=document.querySelector(".wrap h1")||document.querySelector(".wrap h2")||document.querySelector("#wpbody-content .wrap");if(s)"H1"===s.tagName||"H2"===s.tagName?s.parentNode.insertBefore(r,s.nextSibling):s.insertBefore(r,s.firstChild);else{const e=document.getElementById("wpbody-content");e&&e.insertBefore(r,e.firstChild)}setTimeout(function(){r.parentNode&&(r.style.transition="opacity 0.3s",r.style.opacity="0",setTimeout(function(){r.remove()},300))},1e4),r.scrollIntoView({behavior:"smooth",block:"nearest"})}function n(){document.querySelectorAll(".replace-media-button").forEach(e=>{e.removeEventListener("click",o),e.addEventListener("click",o)})}function o(n){n.preventDefault();const o=this.getAttribute("data-attachment-id");if(!o)return;const i=document.createElement("input");i.type="file",i.style.display="none",document.body.appendChild(i);const r=this;i.addEventListener("change",function(){if(0===this.files.length)return void document.body.removeChild(i);const n=this.files[0];r.disabled=!0,r.textContent=(0,e.__)("Replacingâ€¦","smart-media-replacement"),function(n,o,i){const r=new FormData;r.append("action","replace_media_file"),r.append("nonce",window.replaceMediaData.nonce),r.append("attachment_id",n),r.append("replacement_file",o),fetch(window.replaceMediaData.ajaxUrl,{method:"POST",body:r,credentials:"same-origin"}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(n=>{n.success?window.location.reload():(t(n.data||(0,e.__)("Error replacing file.","smart-media-replacement"),i),i&&(i.disabled=!1,i.textContent=(0,e.__)("Replace File","smart-media-replacement")))}).catch(n=>{t((0,e.__)("Error replacing file:","smart-media-replacement")+" "+n.message,i),i&&(i.disabled=!1,i.textContent=(0,e.__)("Replace File","smart-media-replacement"))})}(o,n,r),document.body.removeChild(i)}),i.click()}})})();