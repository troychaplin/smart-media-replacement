(()=>{"use strict";const e=window.wp.i18n;document.addEventListener("DOMContentLoaded",function(){if(void 0!==window.smartMediaReplacementData&&(n(),"undefined"!=typeof wp&&wp.media)){const e=wp.media.view.Attachment.Details;e&&(wp.media.view.Attachment.Details=e.extend({render(){return e.prototype.render.apply(this,arguments),setTimeout(n,100),this}}))}function t(t,n){if(n&&function(t,n){const o=t.closest("tr");if(!o)return!1;const r=o.nextElementSibling;r&&r.classList.contains("smart-media-replacement-inline-error")&&r.remove();const i=document.createElement("tr");i.className="smart-media-replacement-inline-error";const a=o.querySelectorAll("td, th").length,s=document.createElement("td");s.colSpan=a,s.style.padding="8px 12px",s.style.backgroundColor="#fcf0f1",s.style.borderLeft="4px solid #d63638";const c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",c.style.justifyContent="space-between";const l=document.createElement("span");l.innerHTML='<strong style="color: #d63638;">'+(0,e.__)("Error:","smart-media-replacement")+"</strong> "+n,c.appendChild(l);const d=document.createElement("button");return d.type="button",d.className="button-link",d.style.color="#d63638",d.style.textDecoration="none",d.style.cursor="pointer",d.textContent=(0,e.__)("Dismiss","smart-media-replacement"),d.addEventListener("click",function(){i.remove()}),c.appendChild(d),s.appendChild(c),i.appendChild(s),o.parentNode.insertBefore(i,o.nextSibling),setTimeout(function(){i.parentNode&&(i.style.transition="opacity 0.3s",i.style.opacity="0",setTimeout(function(){i.remove()},300))},1e4),i.scrollIntoView({behavior:"smooth",block:"nearest"}),!0}(n,t))return;const o="smart-media-replacement-error-notice",r=document.getElementById(o);r&&r.remove();const i=document.createElement("div");i.id=o,i.className="notice notice-error is-dismissible",i.style.marginTop="20px",i.style.marginBottom="20px";const a=document.createElement("p");a.innerHTML="<strong>"+(0,e.__)("Media Replacement Error:","smart-media-replacement")+"</strong> "+t,i.appendChild(a);const s=document.createElement("button");s.type="button",s.className="notice-dismiss",s.innerHTML='<span class="screen-reader-text">'+(0,e.__)("Dismiss this notice.","smart-media-replacement")+"</span>",s.addEventListener("click",function(){i.remove()}),i.appendChild(s);const c=document.querySelector(".wrap h1")||document.querySelector(".wrap h2")||document.querySelector("#wpbody-content .wrap");if(c)"H1"===c.tagName||"H2"===c.tagName?c.parentNode.insertBefore(i,c.nextSibling):c.insertBefore(i,c.firstChild);else{const e=document.getElementById("wpbody-content");e&&e.insertBefore(i,e.firstChild)}setTimeout(function(){i.parentNode&&(i.style.transition="opacity 0.3s",i.style.opacity="0",setTimeout(function(){i.remove()},300))},1e4),i.scrollIntoView({behavior:"smooth",block:"nearest"})}function n(){document.querySelectorAll(".smart-media-replacement-button").forEach(e=>{e.removeEventListener("click",o),e.addEventListener("click",o)})}function o(n){n.preventDefault();const o=this.getAttribute("data-attachment-id");if(!o)return;const r=document.createElement("input");r.type="file",r.style.display="none",document.body.appendChild(r);const i=this;r.addEventListener("change",function(){if(0===this.files.length)return void document.body.removeChild(r);const n=this.files[0];i.disabled=!0,i.textContent=(0,e.__)("Replacingâ€¦","smart-media-replacement"),function(n,o,r){const i=new FormData;i.append("action","smart_media_replacement_file"),i.append("nonce",window.smartMediaReplacementData.nonce),i.append("attachment_id",n),i.append("replacement_file",o),fetch(window.smartMediaReplacementData.ajaxUrl,{method:"POST",body:i,credentials:"same-origin"}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(n=>{n.success?window.location.reload():(t(n.data||(0,e.__)("Error replacing file.","smart-media-replacement"),r),r&&(r.disabled=!1,r.textContent=(0,e.__)("Replace File","smart-media-replacement")))}).catch(n=>{t((0,e.__)("Error replacing file:","smart-media-replacement")+" "+n.message,r),r&&(r.disabled=!1,r.textContent=(0,e.__)("Replace File","smart-media-replacement"))})}(o,n,i),document.body.removeChild(r)}),r.click()}})})();